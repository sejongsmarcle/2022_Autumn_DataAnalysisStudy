# DATA ANALYSIS STUDY WEEK 6 WORKOUT
-----
## urllib ë¼ì´ë¸ŒëŸ¬ë¦¬
```python
import urllib.request
```
- `urlopen()` : HTML, ì´ë¯¸ì§€ ë“± íŒŒì¼ì— ëŒ€í•œ ìŠ¤íŠ¸ë¦¼(stream)ì„ ì—´ê³ , ë©”ëª¨ë¦¬ì— ì—…ë¡œë“œí•˜ëŠ” í•¨ìˆ˜
> `read()` í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ì—¬ ë©”ëª¨ë¦¬ì— ì˜¬ë¦° ê°ì²´ë¥¼ ë°ì´í„°í™” í•  ìˆ˜ ìˆë‹¤
- `urlretrieve(url, savename)` : urlì„ savenameì´ë¼ëŠ” ì´ë¦„ì˜ íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ëŠ” í•¨ìˆ˜

> ì˜ˆì‹œ
```python
#urllib.request ëª¨ë“ˆ ì¶”ì¶œ
import urllib.request

# URL ë³€ìˆ˜ì— urlì£¼ì†Œ ì €ì¥
url = "https://shared-comic.pstatic.net/thumb/webtoon/626907/thumbnail/title_thumbnail_20150407141027_t83x90.jpg"
savename = "urldownload02.png"

# urlopen() í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ urlì˜ ê°ì²´ ë©”ëª¨ë¦¬ì— ì—…ë¡œë“œí•˜ì—¬ result ë³€ìˆ˜ì— ì €ì¥
result = urllib.request.urlopen(url)

# read() í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ resultë¥¼ ë°ì´í„°í™” í•˜ê³  data ë³€ìˆ˜ì— ì €ì¥
data = result.read()
print('# type(data) :', type(data))

# open() í•¨ìˆ˜ë¡œ íŒŒì¼ ê°ì²´(mode="wb")ë¥¼ êµ¬í•˜ê³  í•´ë‹¹ ê°ì²´ë¥¼ .writeë¥¼ ì´ìš©í•´ ë‹¤ìš´ë¡œë“œ
with open(savename, mode="wb") as f:
    f.write(data)
    print(savename + " íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")
```
-----
## BeautifulSoup ë¼ì´ë¸ŒëŸ¬ë¦¬
```python
from bs4 import BeautifulSoup
```
íŒŒì´ì¬ì—ì„œ í¬ë¡¤ë§ì„ í•´ì£¼ëŠ” ëŒ€í‘œì ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬

### HTML ê¸°ì´ˆ ì„¤ëª…
|í•­ëª©|ì„¤ëª…|
|-----------|-----------|
|ìš”ì†Œ(Element)|ì‹œì‘ íƒœê·¸ì™€ ì¢…ë£Œ íƒœê·¸ì˜ ì¡°í•©|
|íƒœê·¸(Tag)|<> ì•ˆì— ë“¤ì–´ê°€ ìˆëŠ” ëª…ë ¹ì–´|
|ì†ì„±(attribute)|ì‹œì‘íƒœê·¸ ì•ˆì— ì‚½ì…ë˜ë©°, [í‚¤="ê°’"]ì˜ í˜•íƒœë¡œ êµ¬ì„±ë¨|
|ê°’(Value)|ì†ì„±ì— ë“¤ì–´ê°€ëŠ” ì‹¤ì œ ê°’|

> ì˜ˆì‹œ(fruit.html)
```html
<body>
	<p class="ptag red" align="center">ì‚¬ê³¼</p>
	<p class="ptag yellow" align="center">ì°¸ì™¸</p>
	<p class="ptag blue" align="center">ë¸”ë£¨ë² ë¦¬</p>
	<div id="container">
		<p class="hard">ê³¼ì¼</p>
	</div>

</body>
```
ìì„¸íˆ ì•Œì•„ë³´ì.
- `<p class="ptag red" align="center">`
> ì†ì„±ì€ `class`ì™€ `align` / `class`ì˜ ê°’ì€ `ptag`ì™€ `red` / `align`ì˜ ê°’ì€ `center`
- ë¶€ëª¨-ìì‹ íƒœê·¸
> `<body></body>` íƒœê·¸ëŠ” ë¶€ëª¨íƒœê·¸, `<p></p>`ì™€ `<div></div>`íƒœê·¸ëŠ” ìì‹íƒœê·¸

### BeautifulSoupë¡œ íƒœê·¸ ì†ì„± ë‹¤ë£¨ê¸°
|ê´€ë ¨í•¨ìˆ˜|ì„¤ëª…|
|--|--|
|ê°ì²´.select_one(<ì„ íƒì>)|CSSì„ íƒì(selector)ë¡œ ìš”ì†Œ í•˜ë‚˜ë¥¼ ì¶”ì¶œ|
|ê°ì²´.find(tag[, attributes])|tagë¼ëŠ” íƒœê·¸ ì¤‘ ì¡°ê±´ì— ë§ëŠ” 1ë²ˆì§¸ íƒœê·¸ë¥¼ í‘œì‹œ|
|ê°ì²´.findall(tag, attributes, limit=ìˆ«ì)|ì´ê±´ì˜ëª°ë£¨ê² ë„¤|
|ê°ì²´.attrs['ì†ì„±ì´ë¦„']|í•´ë‹¹ ì†ì„±ë“¤ì„ ë”•ì…”ë„ˆë¦¬ í˜•ì‹ìœ¼ë¡œ í‘œì‹œ|
|ê°ì²´.children|í•´ë‹¹ íƒœê·¸ì˜ ìì‹ íƒœê·¸ë¥¼ ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜(ì£¼ë¡œ forë¬¸ì—ì„œ ì‚¬ìš©)|
|ê°ì²´.parent|í•´ë‹¹ íƒœê·¸ì˜ ë¶€ëª¨ íƒœê·¸ë¥¼ ë¦¬ì‹œíŠ¸ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜|
|ê°ì²´.find_parent()|í˜„ì¬ íƒœê·¸ì˜ ë°”ë¡œ ìœ„ ë¶€ëª¨ íƒœê·¸ë¥¼ íƒìƒ‰|
|ê°ì²´.find_parents()|í˜„ì¬ íƒœê·¸ì˜ ìƒìœ„ì— ìˆëŠ” ëª¨ë“  ë¶€ëª¨ íƒœê·¸ íƒìƒ‰(forë¬¸ìœ¼ë¡œ ì¶”ì¶œ)|

> ì˜ˆì‹œ
```python
from bs4 import BeautifulSoup

html = open("fruits.html", "r", encoding="utf-8")     #open() í•¨ìˆ˜ë¡œ fruits.htmlì„ ì½ê¸° ì „ìš©(r)ìœ¼ë¡œ ì¶”ì¶œ
soup = BeautifulSoup(html, "html.parser")       #BeautifulSoup() í•¨ìˆ˜ë¡œ 'html.parser' íŒŒì„œë¡œ html í•´ì„
body = soup.select_one("body")            #select_one("body") í•¨ìˆ˜ë¡œ bodyíƒœê·¸ì˜ ë‚´ìš©ì„ body ë³€ìˆ˜ì— ì €ì¥
ptag = body.find('p')                     #find('p') í•¨ìˆ˜ë¡œ ì²«ë²ˆì§¸ píƒœê·¸ íƒìƒ‰
print('1ë²ˆì§¸ píƒœê·¸ : ', ptag['class'])    #redê°€ ì¶œë ¥ëœë‹¤

#ì†ì„±ê°’ ë³€ê²½
ptag['class'][1] = 'white'      #ptagì˜ ì²«ë²ˆì§¸ class ì†ì„±ê°’ì„ 'white'ë¡œ ë³€ê²½
print('1ë²ˆì§¸ píƒœê·¸ : ', ptag['class'])    #whiteê°€ ì¶œë ¥ëœë‹¤

ptag['id']= 'apple'
print('1ë²ˆì§¸ píƒœê·¸ì˜ id ì†ì„± : ', ptag['id'])

body_tag = soup.find('body')
print(body_tag)

idx = 0
print('children ì†ì„±ìœ¼ë¡œ í•˜ìœ„ í•­ëª© ë³´ê¸°')
print('white character ë¬¸ìê¹Œì§€ í¬í•¨ë¨')
for child in body_tag.children:
    idx += 1
    print(str(idx) + 'ë²ˆì§¸ ìš”ì†Œ :', child)

mydiv = soup.find("div")      #mydiv ë³€ìˆ˜ì— find("div") í•¨ìˆ˜ë¡œ ì°¾ì€ divíƒœê·¸ ë‚´ìš© ì €ì¥
print(mydiv)                #<div></div>ì˜ ëª¨ë“  ë‚´ìš©ì´ ì¶œë ¥ëœë‹¤

print('div íƒœê·¸ì˜ ë¶€ëª¨ íƒœê·¸ëŠ”?')
print(mydiv.parent)

mytag = soup.find("p", attrs={'class':'hard'})    #píƒœê·¸ ì¤‘ ì†ì„±ì´ class, ê·¸ ê°’ì´ hardì¸ ìš”ì†Œë¥¼ mytagì— ì €ì¥
print(mytag)

print('mytag íƒœê·¸ì˜ ë¶€ëª¨ íƒœê·¸ëŠ”?')
print(mytag.find_parent())

print('mytag íƒœê·¸ì˜ ëª¨ë“  ìƒìœ„ ë¶€ëª¨ íƒœê·¸ë“¤ì˜ ì´ë¦„')
parents = mytag.find_parents()
for p in parents :
    print(p.name)
```

### CSS ì„ íƒì
|í•­ëª©|ì„¤ëª…|
|--|--|
|#|id ì†ì„±ì„ ì˜ë¯¸|
|.|class ì†ì„±|
|>|í˜„ì¬ ëŒ€ìƒì˜ ë°”ë¡œ í•˜ìœ„ child íƒìƒ‰|
|^=|ì†ì„±ì˜ ê°’ì´ ~ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ê°’ ì°¾ê¸°|
|$=|ì†ì„±ì˜ ê°’ì´ ~ìœ¼ë¡œ ëë‚˜ëŠ” ê°’ ì°¾ê¸°|
|*=| ì†ì„±ì˜ ê°’ì´ ~ì„ í¬í•¨í•˜ëŠ” ê°’ ì°¾ê¸°|
|nth-of-type(su)|suë²ˆì§¸ í•­ë³µ íƒìƒ‰|

> ì˜ˆì‹œ
```python
html = open(filename, encoding=myencoding)
soup = BeautifulSoup(html, myparser)

#divëŠ” id / cartoon ê°’ í•˜ìœ„ / h1íƒœê·¸ 'í•˜ë‚˜ë§Œ' ì €ì¥
h1 = soup.select_one("div#cartoon > h1").string
print("h1 =", h1)

#divëŠ” id / cartoon ê°’ í•˜ìœ„ / ul íƒœê·¸ / elements í´ë˜ìŠ¤ì†ì„± í•˜ìœ„ / liíƒœê·¸ë“¤ 'ëª¨ë‘' ì €ì¥
li_list = soup.select("div#cartoon > ul.elements > li")
for li in li_list:
    print("li =", li.string)
```
-----
## ìƒˆë¡­ê²Œ ì•Œê²Œëœ ì 
- css ë¬¸ë²• ì„¤ëª… ì‚¬ì´íŠ¸
https://developer.mozilla.org/en-US/docs/Web/CSS/Reference
- html ë¬¸ë²• ì„¤ëª… ì‚¬ì´íŠ¸
https://developer.mozilla.org/ko/docs/Web/HTML/Reference
- ì •ê·œ í‘œí˜„ì‹ ë°±ê³¼
https://regexone.com/


##ë¬¸ì œ
---

<aside>
ğŸ’¡ [ìµœê·œë¯¼]
ê¸°ìƒì²­ ì¼ê¸°ì˜ˆë³´ë¥¼ xmlë¡œ ì €ì¥í•œ í˜ì´ì§€ì—ì„œ ì¼ê¸°ì˜ˆë³´ ì¶œë ¥í•˜ê¸°

1. ê¸°ìƒì²­ í™ˆí˜ì´ì§€ ì ‘ì†([https://www.weather.go.kr/w/index.do](https://www.weather.go.kr/w/index.do))
2. RSS ì¶”ì¶œ í˜ì´ì§€ë¡œ ì´ë™
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dcab0613-7ea7-4748-9705-c1d50e95c80f/Untitled.png)
    
3. ì„œìš¸-ê²½ê¸°ë„ RSS í´ë¦­ í›„ ë§í¬ ë³µì‚¬í•˜ì—¬ í™œìš©
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cab58260-b7c4-4b31-9535-34895028e234/Untitled.png)
    

**ì¶œë ¥ì˜ˆì‹œ:**

ê¸°ìƒì²­ ìœ¡ìƒ ì¤‘ê¸°ì˜ˆë³´
â—‹ (ê¸°ì˜¨) 24ì¼(ëª©)~28ì¼(ì›”) ì•„ì¹¨ ê¸°ì˜¨ì€ 1~9ë„, ë‚® ê¸°ì˜¨ì€ 12~16ë„ë¡œ ì˜¤ëŠ˜(20ì¼, ìµœì €ê¸°ì˜¨ 4~11ë„, ìµœê³ ê¸°ì˜¨ 17~20ë„)ë³´ë‹¤ ì¡°ê¸ˆ ë‚®ê² ìŠµë‹ˆë‹¤.

</aside>

```python
import re
from bs4 import BeautifulSoup
from urllib.request import urlopen

url = "http://www.kma.go.kr/weather/forecast/mid-term-rss3.jsp?stnId=109"
html = urlopen(url)
soup = BeautifulSoup(html, "html.parser")

myweather = soup.find("title").string
info = soup.find("wf").string
print(myweather)
print(info)
```
